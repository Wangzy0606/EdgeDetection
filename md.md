### **1. Заголовочные файлы и пространства имён (头文件与命名空间)**
```cpp
#include <opencv2/opencv.hpp>  // Основной заголовочный файл библиотеки OpenCV (OpenCV库的核心头文件)
#include <iostream>             // Стандартные потоки ввода/вывода (标准输入输出流)
using namespace std;            // Использование пространства имён std (例如cout直接代替std::cout)
using namespace cv;             // Использование пространства имён OpenCV (例如Mat直接代替cv::Mat)
```

### **2. Структура основной функции (主函数结构)**
```cpp
int main()
{
    // Тело программы (代码主体...)
    return 0;
}
```

### **3. Загрузка и отображение изображения (图像加载与显示)**
```cpp
Mat img = imread("C:/Users/34418/Desktop/EdgeDetectionProject/images/test.jpg");
```
- **Функция:** Чтение файла изображения по указанному пути (从指定路径读取图像文件)
- **Важно:** В Windows используйте `/` или `\\` в путях (Windows路径需使用/或\\，建议改用相对路径（如"./images/test.jpg"）)

```cpp
if(img.empty()) {
    cout << "Не удалось загрузить изображение, проверьте путь!" << endl;
    return -1;
}
```
- **Обработка ошибок:** Проверка успешной загрузки изображения (检查图像是否加载成功，避免后续操作崩溃)

```cpp
imshow("Исходное изображение", img);
waitKey(0);
```
- **Отображение:** Показ изображения с заголовком "Исходное изображение" (窗口标题为"原始图像")
- **waitKey(0):** Ожидание нажатия клавиши для продолжения (参数0表示无限等待)

### **4. Предварительная обработка изображения (图像预处理)**
```cpp
Mat img_gray;
cvtColor(img, img_gray, COLOR_BGR2GRAY);
```
- **Преобразование:** Конвертация цветного изображения BGR в оттенки серого (边缘检测通常在灰度图上进行)

```cpp
Mat img_blur;
GaussianBlur(img_gray, img_blur, Size(3, 3), 0);
```
- **Размытие:** Сглаживание изображения с ядром 3x3 для уменьшения шума (使用3x3核进行平滑处理，减少噪声对边缘检测的干扰)
- **Параметры:** Size(3,3) - размер ядра, 0 - автоматический расчёт стандартного отклонения (Size(3,3)是卷积核大小，最后一个0表示自动计算标准差)

### **5. Детекция краёв методом Sobel (Sobel边缘检测)**
```cpp
Mat sobelx, sobely, sobelxy;
Sobel(img_blur, sobelx, CV_64F, 1, 0, 5);  // Градиент по X (X方向梯度)
Sobel(img_blur, sobely, CV_64F, 0, 1, 5);  // Градиент по Y (Y方向梯度)
Sobel(img_blur, sobelxy, CV_64F, 1, 1, 5); // Комбинация X и Y (XY方向组合)
```
- **Принцип:** Обнаружение краёв путём вычисления градиента изображения (通过计算图像梯度来检测边缘)
- **Направления:**
  - `1,0`: Только по X (горизонтальные края) (只计算X方向（水平边缘）)
  - `0,1`: Только по Y (вертикальные края) (只计算Y方向（垂直边缘）)
  - `1,1`: Оба направления (同时计算两个方向)
- **Параметры:**
  - `CV_64F`: Тип данных выходного изображения (64-битное число с плавающей точкой) (输出图像的数据类型（64位浮点）)
  - `5`: Размер ядра оператора Sobel (Sobel算子内核大小)

```cpp
imshow("Sobel X", sobelx);
waitKey(0);
// Аналогично для sobely и sobelxy...
```
- **Отображение результатов:** Показ краёв в разных направлениях (分别展示不同方向的边缘检测效果)

### **6. Детекция краёв методом Canny (Canny边缘检测)**
```cpp
Mat edges;
Canny(img_blur, edges, 100, 200, 3, false);
```
- **Преимущество:** Более продвинутый алгоритм с чёткими линиями краёв (比Sobel更高级，能提取更清晰的边缘线)
- **Ключевые параметры:**
  - `100`: Нижний порог (ниже - не край) (低阈值（低于此值视为非边缘）)
  - `200`: Верхний порог (выше - сильный край) (高阈值（高于此值视为强边缘）)
  - `3`: Размер апертуры Sobel (Sobel算子孔径大小)
  - `false`: Не использовать более точный (но медленный) расчёт градиента L2 (不使用更精确的L2梯度计算)

### **7. Освобождение ресурсов (资源释放)**
```cpp
destroyAllWindows();
```
- **Функция:** Автоматическое закрытие всех окон OpenCV при завершении программы (程序结束时自动关闭所有OpenCV创建的窗口)

### **Последовательность выполнения (代码执行流程总结):**
1. Загрузка и отображение исходного изображения (加载并显示原始图像)
2. Преобразование в оттенки серого → Размытие по Гауссу для шумоподавления (转为灰度图 → 高斯模糊降噪)
3. Обнаружение краёв Sobel (X/Y/XY) с отображением (用Sobel算子检测X/Y/XY方向边缘并显示)
4. Обнаружение краёв Canny с отображением (用Canny算法检测边缘并显示)
5. Пошаговый просмотр результатов по нажатию клавиш (按任意键逐步查看结果)
6. Автоматическое закрытие окон (最终自动关闭所有窗口)

### **Типичные результаты (典型输出效果):**
- **Sobel X:** Основные вертикальные края (主要显示垂直方向的边缘)
- **Sobel Y:** Основные горизонтальные края (主要显示水平方向的边缘)
- **Canny edge detection:** Наиболее чёткие и связные линии краёв (最清晰的连贯边缘线条)

**Совет:** Экспериментируйте с размером ядра размытия и порогами Canny для наблюдения изменений. (建议尝试调整高斯模糊的核大小、Canny的阈值等参数观察效果变化。)


以下是代码的详细中文解释：

### 1. 头文件与命名空间
```cpp
#include <opencv2/opencv.hpp>  // OpenCV库的核心头文件
#include <iostream>             // 标准输入输出流
using namespace std;            // 使用std命名空间（例如cout直接代替std::cout）
using namespace cv;             // 使用OpenCV命名空间（例如Mat直接代替cv::Mat）
```

### 2. 主函数结构
```cpp
int main()
{
    // 代码主体...
    return 0;
}
```

### 3. 图像加载与显示
```cpp
Mat img = imread("C:/Users/34418/Desktop/EdgeDetectionProject/images/test.jpg");
```
- **功能**：从指定路径读取图像文件
- **注意**：Windows路径需使用`/`或`\\`，建议改用相对路径（如`"./images/test.jpg"`）

```cpp
if(img.empty()) {
    cout << "无法加载图像，请检查路径是否正确！" << endl;
    return -1;
}
```
- **错误处理**：检查图像是否加载成功，避免后续操作崩溃

```cpp
imshow("原始图像", img);
waitKey(0);
```
- **显示图像**：窗口标题为"原始图像"
- **waitKey(0)**：暂停程序，按任意键继续（参数0表示无限等待）

### 4. 图像预处理
```cpp
Mat img_gray;
cvtColor(img, img_gray, COLOR_BGR2GRAY);
```
- **颜色转换**：将BGR彩色图转为灰度图（边缘检测通常在灰度图上进行）

```cpp
Mat img_blur;
GaussianBlur(img_gray, img_blur, Size(3, 3), 0);
```
- **高斯模糊**：使用3x3核进行平滑处理，减少噪声对边缘检测的干扰
- **参数说明**：`Size(3,3)`是卷积核大小，最后一个0表示自动计算标准差

### 5. Sobel边缘检测
```cpp
Mat sobelx, sobely, sobelxy;
Sobel(img_blur, sobelx, CV_64F, 1, 0, 5);  // X方向梯度
Sobel(img_blur, sobely, CV_64F, 0, 1, 5);  // Y方向梯度
Sobel(img_blur, sobelxy, CV_64F, 1, 1, 5); // XY方向组合
```
- **原理**：通过计算图像梯度来检测边缘
  - `1,0`：只计算X方向（水平边缘）
  - `0,1`：只计算Y方向（垂直边缘）
  - `1,1`：同时计算两个方向
- **参数说明**：
  - `CV_64F`：输出图像的数据类型（64位浮点）
  - `5`：Sobel算子内核大小

```cpp
imshow("Sobel X", sobelx);
waitKey(0);
// 同理显示sobely和sobelxy...
```
- **结果显示**：分别展示不同方向的边缘检测效果

### 6. Canny边缘检测
```cpp
Mat edges;
Canny(img_blur, edges, 100, 200, 3, false);
```
- **算法优势**：比Sobel更高级，能提取更清晰的边缘线
- **关键参数**：
  - `100`：低阈值（低于此值视为非边缘）
  - `200`：高阈值（高于此值视为强边缘）
  - `3`：Sobel算子孔径大小
  - `false`：不使用更精确的L2梯度计算

### 7. 资源释放
```cpp
destroyAllWindows();
```
- **作用**：程序结束时自动关闭所有OpenCV创建的窗口

---

### 代码执行流程总结：
1. 加载并显示原始图像  
   → 转为灰度图 → 高斯模糊降噪  
   → 用Sobel算子检测X/Y/XY方向边缘并显示  
   → 用Canny算法检测边缘并显示  
   → 按任意键逐步查看结果  
   → 最终自动关闭所有窗口

### 典型输出效果：
- `Sobel X`：主要显示垂直方向的边缘
- `Sobel Y`：主要显示水平方向的边缘
- `Canny edge detection`：最清晰的连贯边缘线条

建议尝试调整高斯模糊的核大小、Canny的阈值等参数观察效果变化。